generator client {
  provider = "prisma-client-js"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model User {
  id             String          @id @default(uuid())
  email String @unique
  display_name  String?
  username String?

  created_at     DateTime        @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @db.Timestamp(6)
  platforms SocialPlatform[]

  badge BadgeConfig?
}

model SocialPlatform {
  id           String    @id @default(uuid())
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @db.Timestamp(6)
  currentScore BigInt?   @default(0)
  lastFetched  DateTime? @default(now()) @db.Timestamp(6)

  type SocialType

  userId  String
  User         User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, type])
}

model BadgeConfig {
  id String @id @default(uuid())

  userId String
  User  User @relation(fields: [userId], references: [id], onDelete: Cascade)

  enabledPlatforms SocialType[]

  showScore Boolean @default(true)

  @@unique([userId])
}

enum SocialType {
  GITHUB
  TWITTER_X
  STACK_OVERFLOW
  FIGMA
  BEHANCE
}
